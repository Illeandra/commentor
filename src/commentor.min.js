/* mini commentor js ver 1  - copyright by ilhamb */
class Commentor{constructor(e={wrapper:null,data:[],id:null,icons:null,maxLength:250,minLength:50}){switch(typeof e.wrapper){case"string":if(!document.getElementById(e.wrapper))return console.error("%c（；￣ェ￣）","color: red; background-color: white;padding: 2px; border-radius: 100px","ERROR: wrapper id not found"),!1;e=render(document.getElementById(e.wrapper),e.icons,e.data,e.maxLength,e.minLength),this.Prototype();break;case"object":e=render(e.wrapper,e.icons,e.data,e.maxLength,e.minLength),this.Prototype();break;default:console.error("%c（；￣ェ￣）","color: red; background-color: white;padding: 2px; border-radius: 100px","ERROR: wrapper type not recognized")}this.onSave=t=>{e.onSave(t)},this.setContentID=t=>{e.setContentID(t)},this.setOption=t=>{e.option({Max:t.Max,Min:t.Min,illegalString:t.Exception})},this.setComments=t=>{e.create(t)},this.setUser=t=>{e.setUser(t)},this.setTitle=t=>{e.setTitle(t)},this.countDown=t=>{e.countDown(t)}}Prototype(){}}function render(e,t,n,r,a){let o,i,l,s,c,d,m,u,E,p,h=TextareaManeger(),v=function(){let e,t,n,r,a=["−","+","×","÷"],o=0;function i(t){let r=a[Math.floor(Math.random()*a.length)];n={point1:l("÷"==r?1:0,10),point2:l("÷"==r?1:0,10),method:r},e=t;var o=e.getContext("2d");o.clearRect(0,0,e.width,e.height),o.font="15px Georgia",o.fillText("pass boot verification",10,50),o.font="3rem Verdana";var i=o.createLinearGradient(0,0,e.width,0);i.addColorStop(l(0,1)," magenta"),i.addColorStop(l(0,1),"blue"),i.addColorStop(l(0,1),"red"),o.fillStyle=i,o.fillText(n.point1+n.method+n.point2+" = ",15,100);for(let e=0;e<10;e++)o.beginPath(),o.strokeStyle=i,o.lineWidth=2,o.moveTo(0,l(60,150)),o.lineTo(300,l(50,150)),o.stroke()}function l(e,t){return Math.floor(Math.random()*(t-e+1)+e)}const s={"+":function(e,t){return e+t},"−":function(e,t){return e-t},"×":function(e,t){return e*t},"÷":function(e,t){return e/t}};return{setCanvas:e=>{i(e)},setInput:e=>{t=e},isTrue:()=>{let r=s[n.method](n.point1,n.point2)===Number(t.value);return r&&(i(e),t.value=""),r},reload:t=>{t.getAttribute("disabled")||0!=o||(o=30,clearInterval(r),i(e),t.setAttribute("disabled",!0),t.innerHTML=o,r=setInterval((()=>{o--,t.innerHTML=o,0==o&&(t.innerHTML=null,t.removeAttribute("disabled"),clearInterval(r))}),1e3))}}}(),_=30,b=!1,f=null,g=ELEMENT("div",{attr:{class:"_cmm-wrapper"},inner:[ELEMENT("div",{attr:{class:"_cmm_head"},inner:[ELEMENT("h2",{attr:{class:"_cmm_brand"},inner:"COMMENTOR JS",todo:e=>{i=e}})]}),ELEMENT("div",{attr:{class:"_cmm_body"},todo:e=>{l=e},inner:[ELEMENT("div",{attr:{class:"_cmm_form"},inner:[ELEMENT("div",{attr:{class:"_cmm_group"},inner:[ELEMENT("textarea",{attr:{class:"_cmm_input_large",placeholder:"type here...",contenteditable:"true"},todo:e=>{o=e,h.setElement(e)}}),ELEMENT("div",{attr:{class:"_cmm_icons_wrapp"},todo:e=>{s=e},inner:[ELEMENT("div",{attr:{class:"_cmm_shadow shadow--top"}}),ELEMENT("div",{attr:{class:"_cmm_shadow shadow--bottom"}}),ELEMENT("div",{attr:{class:"_cmm_icon_group"},todo:e=>{t&&t.length>0?t.forEach((t=>{e.append(ELEMENT("span",{attr:{class:"_cmm_icon"},inner:t,todo:e=>{e.addEventListener("click",(()=>{h.focus(),h.insertAtCaret(t)}))}}))})):e.classList.add("__empty"),e.addEventListener("scroll",(()=>{let t=e.parentElement.querySelector(".shadow--top"),n=e.parentElement.querySelector(".shadow--bottom");var r=e.scrollTop-e.offsetHeight;t.style.opacity=r,n.style.opacity=1-r}))}})]}),ELEMENT("div",{attr:{class:"_cmm_group"},inner:[ELEMENT("small",{inner:"Enter the name to be displayed"}),ELEMENT("input",{attr:{class:"_cmm_input_small",placeholder:"enter your name",contenteditable:"true"},todo:e=>{e.onInput(5,20,/[^A-Z\s]/gi),c=e}}),ELEMENT("small",{inner:"Your email address will not be shared"}),ELEMENT("input",{attr:{class:"_cmm_input_small",placeholder:"enter your e-mail",contenteditable:"true"},todo:e=>{e.onInput(0,52,/[^a-z0-9\_\-\@\.]/i),d=e}})]})]}),ELEMENT("div",{attr:{class:"_comm_bot_verify_wrapper"},inner:[ELEMENT("div",{attr:{class:"_verify_content"},inner:[ELEMENT("canvas",{todo:e=>{v.setCanvas(e)}}),ELEMENT("input",{todo:e=>{v.setInput(e)}}),ELEMENT("span",{todo:e=>{e.onclick=()=>v.reload(e)}})]})]}),ELEMENT("div",{attr:{class:"_cmm_form_bottom"},inner:[ELEMENT("button",{attr:{class:"_cmm_btn _cmm_submit"},inner:"comment",todo:e=>{E=e,e.addEventListener("click",(()=>{if(c.value.length<5)return u("ERROR: the number of character names must be more than 4"),!1;if(d.value.length<0)return u("ERROR: the number of email characters must be more than 0"),!1;if(h.getValue().length<r)return u("ERROR: the number of comment characters must be more than  "+r),!1;if(h.getValue().length>a)return u("ERROR: the number of comment characters exceeds the maximum "+a),!1;if(!v.isTrue())return u(!1),!1;let t={user:{name:c.value,email:d.value},text:h.getValue(),id:f};o.value="",c.value="",d.value="",b=!0,u(t),e.setAttribute("disabled",!0),e.setAttribute("disabled-util",_);let n=_;clearInterval(m),m=setInterval((()=>{_--,e.setAttribute("disabled-util",_),0==_&&(_=n,clearInterval(m),e.removeAttribute("disabled"))}),1e3)}))}})]})]})]}),ELEMENT("div",{attr:{class:"_cmm_comments_wrapper"},inner:[ELEMENT("div",{attr:{class:"_cmm_shadow shadow--top"}}),ELEMENT("div",{attr:{class:"_cmm_shadow shadow--bottom"}}),ELEMENT("div",{attr:{class:"_cmm_comments_list"},todo:e=>{p=e,e.addEventListener("scroll",(()=>{let t=e.parentElement.querySelector(".shadow--top"),n=e.parentElement.querySelector(".shadow--bottom");var r=e.scrollTop-e.offsetHeight;t.style.opacity=r,n.style.opacity=1-r}))}})]})]});e.append(g),console.log("%c(づ￣ ³￣)づ %cCOMMENTOR IS RUNNING","color: black; background-color: white; padding: 2px; border-radius: 100px","color: #00f7ff; font-weight: 900; padding-left: 10px");let L=[];return window.addEventListener("click",(e=>{e.target==o?s.classList.add("_cmm_open"):e.target.classList.contains("_cmm_icon")||s.classList.remove("_cmm_open")})),{wrapper:e,onSave:e=>{u=e,e.countDown&&E.setAttribute("disabled",!0)},countDown:e=>{_=e},setContentID:e=>{f=e},option:e=>{r=e.Min,a=e.Max,h.option(e)},create:e=>{!function(e){p.querySelector("[empty-placeholder]")&&p.querySelector("[empty-placeholder]").remove();let t=0;e.forEach((n=>{if(t++,L.includes(n.id))return!1;L.push(n.id);let r=ELEMENT("div",{attr:{class:"_cmm_comments_col",id:n.id},inner:[ELEMENT("h3",{attr:{class:"_cmm_uname"},inner:n.name}),ELEMENT("div",{attr:{class:"_cmm_content"},inner:[n.content,ELEMENT("span",{attr:{class:"_cmm_date"},inner:n.date})]})]});p.append(r),t==e.length&&b&&(r.classList.add("--active"),setTimeout((()=>{r.scrollIntoView({behavior:"smooth"})}),500))}))}(e)},setUser:e=>{c.value=e.name,d.value=e.email,e.name.length>0&&(c.disabled=!0),e.email.length>0&&(d.disabled=!0)},setTitle:e=>{i.innerHTML=e}}}function ELEMENT(e="div",t={attr:{},inner:[],todo:null}){let n=document.createElement(e),r=t?t.attr:{},a=t?t.inner:"",o=t?t.todo:null;return r&&Object.keys(r).forEach((e=>{let t=e.replace(/[A-Z]/g,"-$&").toLowerCase();n.setAttribute(t,r[e])})),n.setInner=e=>{switch(typeof e){case"string":n.innerHTML=e;break;case"object":Array.isArray(e)?e.forEach((e=>{n.append(e)})):n.append(e);break;default:console.error("（；￣ェ￣） ERROR: can't set inner because value type is unknown !")}},n.getInner=()=>n.innerHTML,n.onInput=function(e,t,r="//g"){n.addEventListener("keypress",(e=>{if(8!=e.keyCode&&e.key.match(r))return e.preventDefault(),!1})),n.addEventListener("keydown",(e=>{if(8!=e.keyCode&&e.key.match(r))return e.preventDefault(),!1})),n.addEventListener("keyup",(e=>{if(8!=e.keyCode&&e.key.match(r))return e.preventDefault(),!1})),n.addEventListener("input",(()=>{n.value=n.value.replace(r,""),n.setAttribute("maxlength",t),n.setAttribute("minlength",e)}))},a&&n.setInner(a),o&&o(n),n}function TextareaManeger(){let e,t;return{setElement:t=>{e=t},insertAtCaret:t=>{if(null==e)return alert("you have to set the element first :`("),!1;let n=" "+t+" ",r=e.selectionStart,a=e.selectionEnd;e.value=e.value.substring(0,r)+n+e.value.substring(a,e.value.length),e.focus(),e.selectionEnd=r+n.length},getValue:()=>e.value,focus:()=>{e.focus()},option:n=>{e.onInput(n.Min,n.Max,n.illegalString),t=n}}}
